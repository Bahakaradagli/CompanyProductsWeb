<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Marmara Dağıtım – Ürünler</title>

  <!-- fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- ortak -->
  <link rel="stylesheet" href="common.css">
  <link rel="stylesheet" href="index.css">
  <!-- bu sayfanın stilleri -->
  <link rel="stylesheet" href="products.css">
</head>
<body>
  <!-- ==== DESKTOP NAV ==== -->
  <header class="desknav" role="banner" style="--accent:#54577D">
    <div class="desknav__wrap">
      <div class="desknav__inner">
        <div class="desknav__brand">
          <img class="desknav__logo" src="assets/logo-150.png" alt="Marmara Dağıtım Logo" onerror="this.style.display='none'">
          <span class="desknav__title">MARMARA DAĞITIM</span>
        </div>
        <nav class="desknav__tabs" aria-label="Ana gezinme">
          <a class="desknav__tab" href="index.html">
            <span class="desknav__icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M10 6V5a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v1m-9 4h14m-15 0a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7Z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            </span>
            <span>Markalar</span>
          </a>
          <a class="desknav__tab" href="products.html" aria-current="page">
            <span class="desknav__icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M4 7h7v7H4V7Zm9 0h7v7h-7V7ZM8 17h8v3H8v-3Z" fill="currentColor"/></svg>
            </span>
            <span>Ürünler</span>
          </a>
          <a class="desknav__tab" href="contact.html">
            <span class="desknav__icon" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M3 10h18M5 10v8m4-8v8m6-8v8m4-8v8M3 18h18M12 4 3 8h18L12 4Z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            </span>
            <span>İletişim</span>
          </a>
        </nav>
      </div>
    </div>
  </header>

  <!-- ==== SAYFA İÇERİĞİ ==== -->
  <main class="container">
    <!-- Markalar sayfasıyla aynı h2 konumu ve boyutu -->
    <h2 id="pageTitle" class="page-title">Ürünler</h2>

    <div class="products">
      <div id="productList" class="list"><!-- JS dolduracak --></div>
    </div>
  </main>

  <footer>
    <small>© <span id="y"></span> Marmara Dağıtım • GitHub Pages</small>
  </footer>

  <!-- Aktif sekme emniyet -->
  <script>
    (function(){
      const here = (location.pathname.split('/').pop() || 'products.html');
      document.querySelectorAll('.desknav__tab').forEach(t=>{
        const isHere = (t.getAttribute('href')||'') === here || (here==='' && t.getAttribute('href')==='products.html');
        t.setAttribute('aria-current', isHere?'page':'false');
      });
    })();
  </script>

  <!-- Ürünler -->
  <script>
    const $ = (s, r=document) => r.querySelector(s);

    async function loadJSON(url){
      const res = await fetch(url, {cache:'no-store'});
      if(!res.ok) throw new Error(url);
      return res.json();
    }
    function fallbackImg(imgEl, text='IMG'){
      imgEl.onerror = null;
      imgEl.src = 'https://dummyimage.com/160x160/1a1a1a/ffffff&text=' + encodeURIComponent(text);
    }
    function listItem(p){
      const row = document.createElement('a');
      row.className = 'list-item';
      row.href = '#';
      row.innerHTML = `
        <div class="list-left">
          <img class="list-thumb" src="${p.img}" alt="${p.name}">
          <div class="list-text">
            <div class="list-name">${p.name}</div>
          </div>
        </div>
        <div class="list-right" aria-hidden="true">
          <svg class="chev" viewBox="0 0 24 24"><path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>`;
      $('.list-thumb', row).onerror = () => fallbackImg($('.list-thumb', row), (p.name||'U')[0]);
      return row;
    }

    (async function init(){
      // Başlık: hash’e göre (Markalar’daki gibi)
      const hash = (location.hash||'').replace('#','');
      const titleMap = { ithal:'İthal Ürünler', '7stick':'7 Stick', bado:'Bado' };
      $('#pageTitle').textContent = (titleMap[hash] || 'Ürünler');

      try{
        const products = await loadJSON('data/products.json');
        const list = (hash ? products.filter(p => p.catalog===hash) : products);

        const wrap = $('#productList');
        wrap.innerHTML = '';
        if(list.length===0){
          const empty = document.createElement('div');
          empty.className = 'list-empty';
          empty.textContent = 'Bu kategoride ürün bulunamadı.';
          wrap.appendChild(empty);
        }else{
          list.forEach(p => wrap.appendChild(listItem(p)));
        }
        $('#y').textContent = new Date().getFullYear();
      }catch(e){
        console.error(e); alert('Ürünler yüklenemedi.');
      }
    })();
  </script>
</body>
</html>